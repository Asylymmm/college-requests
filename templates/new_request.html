{% extends "base.html" %}
{% block title %}Новая заявка{% endblock %}

{% block content %}
<div class="container py-4" style="max-width: 920px;">

  <div class="d-flex align-items-center justify-content-between gap-2 mb-4">
    <div>
      <div class="text-white-50 small">Форма</div>
      <h2 class="text-white m-0">Отправка заявки</h2>
    </div>
    <a class="btn btn-light-soft" href="{{ url_for('student_dashboard') }}">
      <i class="bi bi-arrow-left"></i> Назад в кабинет
    </a>
  </div>

  <div class="card card-premium">
    <div class="card-body p-4 p-md-5">

      <form method="POST" class="needs-validation" novalidate>

        <div class="mb-3">
          <label class="form-label">Тип заявления</label>
          <select name="req_type" class="form-select form-premium" required>
            <option value="" selected disabled>Выберите тип</option>
            <option value="Справка">Справка</option>
            <option value="Заявление">Заявление</option>
            <option value="Перевод/Отчисление">Перевод / Отчисление</option>
            <option value="Обращение">Обращение</option>
          </select>
          <div class="invalid-feedback">Выберите тип заявления.</div>
        </div>

        <div class="mb-3">
          <label class="form-label">Заголовок</label>
          <input name="title" type="text" class="form-control form-premium" placeholder="Например: Справка об обучении" required>
          <div class="invalid-feedback">Заполните заголовок.</div>
        </div>

        <div class="mb-4">
          <label class="form-label">Текст заявки</label>
          <textarea name="body_text" class="form-control form-premium" rows="7"
                    placeholder="Кратко и по делу: что нужно, на какой срок, кому выдать, контакты..." required></textarea>
          <div class="invalid-feedback">Заполните текст заявки.</div>
        </div>

        <div class="d-flex flex-column flex-md-row gap-2 justify-content-between">
          <div class="text-muted small">
            Нажимая «Отправить», вы создаёте заявку со статусом <b>На расмотрении</b>.
          </div>
          <button type="submit" class="btn btn-primary-premium">
            <i class="bi bi-send"></i> Отправить заявку
          </button>
        </div>

      </form>

    </div>
  </div>
</div>

<script>
(() => {
  const forms = document.querySelectorAll('.needs-validation');
  Array.from(forms).forEach(form => {
    form.addEventListener('submit', event => {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      form.classList.add('was-validated');
    }, false);
  });
})();
</script>
{% endblock %}